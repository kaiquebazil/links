<!DOCTYPE html>
<html>
  <head>
    <title>Gerador de Ícones PWA</title>
    <style>
      body {
        font-family: Arial;
        padding: 20px;
      }
      canvas {
        display: none;
      }
      .preview {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin: 20px 0;
      }
      .icon-preview {
        text-align: center;
      }
      .icon-preview img {
        border: 1px solid #ccc;
      }
    </style>
  </head>
  <body>
    <h1>Gerador de Ícones PWA</h1>

    <input type="file" id="imageInput" accept="image/*" />
    <button onclick="generateIcons()">Gerar Ícones</button>
    <button onclick="downloadAll()">Baixar Todos</button>

    <div class="preview" id="preview"></div>

    <script>
      const sizes = [72, 96, 128, 144, 152, 192, 384, 512];

      function generateIcons() {
        const input = document.getElementById("imageInput");
        if (!input.files[0]) return alert("Selecione uma imagem");

        const reader = new FileReader();
        reader.onload = function (e) {
          const img = new Image();
          img.onload = function () {
            const preview = document.getElementById("preview");
            preview.innerHTML = "";

            sizes.forEach((size) => {
              const canvas = document.createElement("canvas");
              canvas.width = size;
              canvas.height = size;
              const ctx = canvas.getContext("2d");

              // Fundo colorido
              ctx.fillStyle = "#58a6ff";
              ctx.fillRect(0, 0, size, size);

              // Calcular tamanho da imagem (80% do canvas)
              const imgSize = size * 0.8;
              const x = (size - imgSize) / 2;
              const y = (size - imgSize) / 2;

              ctx.drawImage(img, x, y, imgSize, imgSize);

              // Adicionar à página
              const dataUrl = canvas.toDataURL("image/png");
              const div = document.createElement("div");
              div.className = "icon-preview";
              div.innerHTML = `
              <div>${size}x${size}</div>
              <img src="${dataUrl}" width="100">
              <div><a href="${dataUrl}" download="icon-${size}x${size}.png">Download</a></div>
            `;
              preview.appendChild(div);
            });
          };
          img.src = e.target.result;
        };
        reader.readAsDataURL(input.files[0]);
      }

      function downloadAll() {
        const links = document.querySelectorAll(".icon-preview a");
        links.forEach((link) => link.click());
      }
    </script>
  </body>
</html>
